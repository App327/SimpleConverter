<!DOCTYPE html>
<html lang="ru" dir="ltr">
 <head>
  <meta charset="utf-8" />
  <title>SimpleConverter</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <style type="text/css">
:root {
 --settings-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAtOTYwIDk2MCA5NjAiIHdpZHRoPSIyNHB4IiBmaWxsPSIjMDAwMDAwIj48cGF0aCBkPSJtMzcwLTgwLTE2LTEyOHEtMTMtNS0yNC41LTEyVDMwNy0yMzVsLTExOSA1MEw3OC0zNzVsMTAzLTc4cS0xLTctMS0xMy41di0yN3EwLTYuNSAxLTEzLjVMNzgtNTg1bDExMC0xOTAgMTE5IDUwcTExLTggMjMtMTV0MjQtMTJsMTYtMTI4aDIyMGwxNiAxMjhxMTMgNSAyNC41IDEydDIyLjUgMTVsMTE5LTUwIDExMCAxOTAtMTAzIDc4cTEgNyAxIDEzLjV2MjdxMCA2LjUtMiAxMy41bDEwMyA3OC0xMTAgMTkwLTExOC01MHEtMTEgOC0yMyAxNXQtMjQgMTJMNTkwLTgwSDM3MFptMTEyLTI2MHE1OCAwIDk5LTQxdDQxLTk5cTAtNTgtNDEtOTl0LTk5LTQxcS01OSAwLTk5LjUgNDFUMzQyLTQ4MHEwIDU4IDQwLjUgOTl0OTkuNSA0MVoiLz48L3N2Zz4=');
 --openinnew-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAtOTYwIDk2MCA5NjAiIHdpZHRoPSIyNHB4IiBmaWxsPSIjMUU5MEZGIj48cGF0aCBkPSJNMjAwLTEyMHEtMzMgMC01Ni41LTIzLjVUMTIwLTIwMHYtNTYwcTAtMzMgMjMuNS01Ni41VDIwMC04NDBoMjgwdjgwSDIwMHY1NjBoNTYwdi0yODBoODB2MjgwcTAgMzMtMjMuNSA1Ni41VDc2MC0xMjBIMjAwWm0xODgtMjEyLTU2LTU2IDM3Mi0zNzJINTYwdi04MGgyODB2MjgwaC04MHYtMTQ0TDM4OC0zMzJaIi8+PC9zdmc+');
}

body {
 background: white;
 color: rgb(30, 30, 30);
 font-family: sans-serif;
}

body.theme-dark {
 background: rgb(30, 30, 30);
 color: white;
}

a {
 color: dodgerblue;
 text-decoration: none;
}

a:hover {
 text-decoration: underline;
}

a:active {
 color: royalblue;
}

a.external {
 padding-right: 17.5px;
 background-image: var(--openinnew-icon);
 background-repeat: no-repeat;
 background-position: right center;
 background-size: 15px;
}

body.theme-dark a {
 color: deepskyblue;
}

body.theme-dark a:active {
 color: dodgerblue;
}

h1 {
 color: darkblue;
 user-select: none;
}

body.theme-dark h1 {
 color: skyblue;
}

#conv-type {
 width: 100%;
 padding: 5px;
 border: 2px solid rgb(200, 200, 200);
 background: rgb(240, 240, 240);
}
#conv-type:hover {
 bafckground: rgb(220, 220, 220);
}
#conv-type:active {
 background: rgb(180, 180, 180);
}
#conv-type:focus {
 outline: 1px dashed royalblue;
 outline-offset: -2px;
}

body.theme-dark #conv-type {
 border: 2px solid rgb(85, 85, 85);
 background: rgb(45, 45, 45);
 color: white;
}

body.theme-dark #conv-type:hover {
 background: rgb(65, 65, 65);
}

body.theme-dark #conv-type:active {
 background: rgb(10, 10, 10);
}

body.theme-dark #conv-type:focus {
 outline: 1px dashed deepskyblue;
}

code {
 padding: 2px;
 border-radius: 2px;
 background: rgb(240, 240, 240);
 border: 1px solid rgb(220, 220, 220);
}

body.theme-dark code {
 background: rgb(50, 50, 50);
 border: 1px solid rgb(100, 100, 100);
}

button, select, textarea, input {
 font-family: inherit;
}

button, select {
 user-select: none;
 cursor: pointer;
 -webkit-tap-highlight-color: transparent;
}

button[disabled] {
 cursor: not-allowed;
}

.from-to {
 display: flex;
 flex-direction: row;
 align-items: center;
 border-top: 1px solid silver;
 border-bottom: 1px solid silver;
 padding: 10px;
 width: calc(100% - 20px);
 overflow: auto;
}

body.theme-dark .from-to {
 border-top: 1px solid rgb(70, 70, 70);
 border-bottom: 1px solid rgb(70, 70, 70);
}

.from-to p {
 margin: 0;
}

.from-to .unit {
 margin-right: 5px;
 border: 1px solid silver;
 background: white;
 padding: 5px;
 border-radius: 5px;
 width: 150px;
 flex-shrink: 0;
}
.from-to .unit:hover {
 background: rgb(240, 240, 240);
 outline: 1px solid silver;
}
.from-to .unit:active {
 background: rgb(210, 210, 210);
}
.from-to .unit:focus {
 outline: 2px solid dodgerblue;
}

body.theme-dark .from-to .unit {
 border: 1px solid rgb(70, 70, 70);
 background: rgb(30, 30, 30);
 color: white;
}
body.theme-dark .from-to .unit:hover {
 background: rgb(90, 90, 90);
 outline: 1px solid rgb(70, 70, 70);
}
body.theme-dark .from-to .unit:active {
 background: rgb(10, 10, 10);
}
body.theme-dark .from-to .unit:focus {
 outline: 2px solid deepskyblue;
}

*[dir="rtl"] .from-to .unit {
 margin-right: 0;
 margin-left: 5px;
}

.from-to .value {
 margin-left: 5px;
 display: flex;
 flex-direction: row;
 align-items: center;
 flex-shrink: 0;
}

*[dir="rtl"] .value {
 margin-left: 0;
 margin-right: 5px;
}

.from-to .value .u {
 margin-left: 2.5px;
 font-size: 0.8rem;
 color: grey;
 user-select: none;
}

body.theme-dark .from-to .value .u {
 color: rgb(200, 200, 200);
}

*[dir="rtl"] .from-to .value .u {
 margin-left: 0;
 margin-right: 2.5px;
}

.from-to.from .value input {
 margin-right: 2.5px;
 padding: 5px;
 width: 100px;
 border: none;
 background: rgb(240, 240, 240);
 border-radius: 5px;
 caret-color: darkblue;
}
.from-to.from .value input:hover {
 background: rgb(230, 230, 230);
}
.from-to.from .value input:active {
 background: rgb(200, 200, 200);
}
.from-to.from .value input:focus {
 outline: 2px solid dodgerblue;
}

body.theme-dark .from-to.from .value input {
 background: rgb(50, 50, 50);
 color: white;
 caret-color: lightblue;
}
body.theme-dark .from-to.from .value input:hover {
 background: rgb(70, 70, 70);
}
body.theme-dark .from-to.from .value input:active {
 background: rgb(20, 20, 20);
}
body.theme-dark .from-to.from .value input:focus {
 outline: 2px solid deepskyblue;
}

*[dir="rtl"] .from-to.from .value input {
 margin-right: 0;
 margin-left: 2.5px;
}

.from-to.to .v {
 font-weight: 700;
}

.formula {
 display: flex;
 flex-direction: row;
 align-items: center;
 margin: 10px 0;
 font-size: 0.9rem;
 overflow: auto;
}

.formula .name {
 margin: 0;
 margin-right: 5px;
 padding: 5px;
 border-radius: 5px;
 background: skyblue;
 user-select: none;
 font-weight: 600;
}

.formula .text {
 margin: 0;
 margin-left: 5px;
}

body.theme-dark .formula .name {
 background: royalblue;
}

*[dir="rtl"] .formula .name {
 margin-right: 0;
 margin-left: 5px;
}

*[dir="rtl"] .formula .text {
 margin-left: 0;
 margin-right: 5px;
}

.settings-btn {
 border: none;
 height: 50px;
 width: 50px;
 position: absolute;
 top: 0;
 right: 0;
 padding: 0;
 background-color: white;
 background-image: var(--settings-icon);
 background-repeat: no-repeat;
 background-position: center;
 background-size: 30px;
}
.settings-btn:hover {
 background: rgba(100, 100, 100, 0.2);
 background-image: var(--settings-icon);
 background-repeat: no-repeat;
 background-position: center;
 background-size: 30px;
}
.settings-btn:active {
 background: rgba(100, 100, 100, 0.5);
 background-image: var(--settings-icon);
 background-repeat: no-repeat;
 background-position: center;
 background-size: 30px;
}
.settings-btn:focus {
 outline: 2px solid dodgerblue;
 outline-offset: -2px;
}

body.theme-dark .settings-btn {
 background-color: rgb(150, 150, 150);
}
body.theme-dark .settings-btn:hover {
 background-color: rgb(170, 170, 170);
}
body.theme-dark .settings-btn:active {
 background-color: rgb(120, 120, 120);
}

.settings-btn.opened {
 background-image: none;
 font-size: 2.0rem;
}

*[dir="rtl"] .settings-btn {
 left: 0;
 right: auto;
}

.win {
 position: fixed;
 width: calc(100% - 10px);
 min-height: 100px;
 max-height: calc(100% - 120px);
 background: white;
 left: 50%;
 top: 50%;
 transform: translate(-50%, -50%) scale(1.0);
 opacity: 0;
 overflow: auto;
 box-shadow: 0 0 7px silver;
 padding: 5px;
 user-select: none;
 animation: showWin 250ms forwards;
}

@keyframes showWin {
 from { opacity: 0; transform: translate(-50%, -50%) scale(1.2); }
 to { opacity: 1; transform: translate(-50%, -50%) scale(1.0); }
}

body.theme-dark .win {
 background: rgb(40, 40, 40);
 box-shadow: 0 0 7px black;
}

.win h2 {
 font-weight: 600;
 border-bottom: 1px solid silver;
 padding: 0 5px;
 width: calc(100% - 10px);
 margin: 5px 0 10px 0;
}

.win h3, .win p {
 margin: 5px 0;
}

.win p {
 font-size: 0.9rem;
}

.win h2.has-close-btn {
 display: flex;
 flex-direction: row;
 align-items: center;
 justify-content: space-between;
 padding-bottom: 5px;
}

.win h2.has-close-btn .text {
 margin-right: 5px;
}

.win h2.has-close-btn .close {
 margin-left: 5px;
 height: 30px;
 width: 30px;
 border: none;
 border-radius: 5px;
 background: rgb(240, 240, 240);
 padding: 0;
 font-size: 20px;
}

body.theme-dark .win h2.has-close-btn .close {
 background: rgb(60, 60, 60);
 color: white;
}

*[dir="rtl"] .win h2.has-close-btn .text {
 margin-left: 5px;
 margin-right: 0;
}

*[dir="rtl"] .win h2.has-close-btn .close {
 margin-left: 0;
 margin-right: 5px;
}

.win h2.has-close-btn .close:hover {
 background: rgb(220, 220, 220);
}
.win h2.has-close-btn .close:active {
 background: rgb(190, 190, 190);
}
.win h2.has-close-btn .close:focus {
 outline: 2px solid deepskyblue;
}

body.theme-dark .win h2.has-close-btn .close:hover {
 background: rgb(80, 80, 80);
}
body.theme-dark .win h2.has-close-btn .close:active {
 background: rgb(30, 30, 30);
}

#settings .datapack-upload {
 display: flex;
 flex-direction: row;
 align-items: center;
 padding: 5px;
 width: calc(100% - 10px);
 overflow: auto;
}

#settings .datapack-upload .file-inp {
 margin-right: 5px;
}

*[dir="rtl"] #settings .datapack-upload .file-inp {
 margin-left: 5px;
 margin-right: 0;
}

#settings .datapack-upload .file-inp::file-selector-button {
 border: 1px solid silver;
 border-radius: 5px;
 padding: 5px 10px;
 background: rgb(250, 250, 250);
}
#settings .datapack-upload .file-inp::file-selector-button:hover {
 background: rgb(230, 230, 230);
}
#settings .datapack-upload .file-inp::file-selector-button:active {
 background: rgb(200, 200, 200);
 border: 1px solid grey;
}
#settings .datapack-upload .file-inp::file-selector-button:focus {
 outline: 1px dashed royalblue;
 outline-offset: -4px;
}

body.theme-dark #settings .datapack-upload .file-inp::file-selector-button {
 border: 1px solid rgb(100, 100, 100);
 background: rgb(50, 50, 50);
 color: white;
}
body.theme-dark #settings .datapack-upload .file-inp::file-selector-button:hover {
 background: rgb(70, 70, 70);
}
body.theme-dark #settings .datapack-upload .file-inp::file-selector-button:active {
 background: rgb(40, 40, 40);
 border: 1px solid silver;
}
body.theme-dark #settings .datapack-upload .file-inp::file-selector-button:focus {
 outline: 1px dashed deepskyblue;
}

#settings .datapack-upload .apply-btn {
 padding: 5px 10px;
 background: dodgerblue;
 color: white;
 border: none;
 border-radius: 5px;
 margin-left: 5px;
}
#settings .datapack-upload .apply-btn:hover {
 background: royalblue;
}
#settings .datapack-upload .apply-btn:active {
 background: rgb(35, 75, 195);
}
*[dir="rtl"] #settings .datapack-upload .apply-btn {
 margin-left: 0;
 margin-right: 5px;
}
#settings .datapack-upload .apply-btn:focus {
 outline: 2px solid skyblue;
}
#settings .datapack-upload .apply-btn[disabled] {
 background: silver;
}

body.theme-dark #settings .datapack-upload .apply-btn {
 background: slateblue;
}
body.theme-dark #settings .datapack-upload .apply-btn:hover {
 background: darkslateblue;
}
body.theme-dark #settings .datapack-upload .apply-btn:active {
 background: rgb(42, 31, 109);
}
body.theme-dark #settings .datapack-upload .apply-btn:focus {
 outline: 2px solid deepskyblue;
}
body.theme-dark #settings .datapack-upload .apply-btn[disabled] {
 background: grey;
}

#settings .datapack-reset-btn {
 margin: 5px;
 padding: 2.5px 7.5px;
 border-radius: 5px;
 border: 1px solid silver;
 background: white;
 color: darkblue;
}
#settings .datapack-reset-btn:hover {
 background: rgb(230, 230, 230);
}
#settings .datapack-reset-btn:active {
 background: rgb(200, 200, 200);
 border: 1px solid grey;
}
#settings .datapack-reset-btn:focus {
 outline: 2px solid skyblue;
}
#settings .datapack-reset-btn[disabled] {
 background: rgb(240, 240, 240);
 color: grey;
 border: 1px solid lightgrey;
}

body.theme-dark #settings .datapack-reset-btn {
 border: 1px solid rgb(100, 100, 100);
 background: rgb(50, 50, 50);
 color: lightskyblue;
}
body.theme-dark #settings .datapack-reset-btn:hover {
 background: rgb(75, 75, 75);
}
body.theme-dark #settings .datapack-reset-btn:active {
 background: rgb(40, 40, 40);
 border: 1px solid silver;
}
body.theme-dark #settings .datapack-reset-btn:focus {
 outline: 2px solid deepskyblue;
}
body.theme-dark #settings .datapack-reset-btn[disabled] {
 background: rgb(75, 75, 75);
 color: grey;
 border: 1px solid rgb(100, 100, 100);
}

.nojs {
 background: rgb(255, 240, 200);
 position: fixed;
 top: 50%;
 left: 50%;
 padding: 5px;
 width: calc(100% - 10px);
 transform: translate(-50%, -50%);
 box-shadow: 0 0 10px silver;
 max-height: calc(100% - 20px);
 overflow: auto;
}

@media (prefers-color-scheme: dark) {
 body.theme-followsys {
  background: rgb(30, 30, 30);
  color: white;
 }
 body.theme-followsys a {
  color: deepskyblue;
 }
 body.theme-followsys a:active {
  color: dodgerblue;
 }
 body.theme-followsys h1 {
  color: skyblue;
 }
 body.theme-followsys #conv-type {
  border: 2px solid rgb(85, 85, 85);
  background: rgb(45, 45, 45);
  color: white;
 }
 body.theme-followsys #conv-type:hover {
  background: rgb(65, 65, 65);
 }
 body.theme-followsys #conv-type:active {
  background: rgb(10, 10, 10);
 }
 body.theme-followsys #conv-type:focus {
  outline: 1px dashed deepskyblue;
 } 
 body.theme-followsys code {
  background: rgb(50, 50, 50);
  border: 1px solid rgb(100, 100, 100);
 }
 body.theme-followsys .from-to {
  border-top: 1px solid rgb(70, 70, 70);
  border-bottom: 1px solid rgb(70, 70, 70);
 }
 body.theme-followsys .from-to .unit {
  border: 1px solid rgb(70, 70, 70);
  background: rgb(30, 30, 30);
  color: white;
 }
 body.theme-followsys .from-to .unit:hover {
  background: rgb(90, 90, 90);
  outline: 1px solid rgb(70, 70, 70);
 }
 body.theme-followsys .from-to .unit:active {
  background: rgb(10, 10, 10);
 }
 body.theme-followsys .from-to .unit:focus {
  outline: 2px solid deepskyblue;
 }
 body.theme-followsys .from-to .value .u {
  color: rgb(200, 200, 200);
 }
 body.theme-followsys .from-to.from .value input {
  background: rgb(50, 50, 50);
  color: white;
  caret-color: lightblue;
 }
 body.theme-followsys .from-to.from .value input:hover {
  background: rgb(70, 70, 70);
 }
 body.theme-followsys .from-to.from .value input:active {
  background: rgb(20, 20, 20);
 }
 body.theme-followsys .from-to.from .value input:focus {
  outline: 2px solid deepskyblue;
 }
 body.theme-followsys .settings-btn {
  background-color: rgb(150, 150, 150);
 }
 body.theme-followsys .settings-btn:hover {
  background-color: rgb(170, 170, 170);
 }
 body.theme-followsys .settings-btn:active {
  background-color: rgb(120, 120, 120);
 }
 body.theme-followsys .win {
  background: rgb(40, 40, 40);
  box-shadow: 0 0 7px black;
 }
 body.theme-followsys .win h2.has-close-btn .close {
  background: rgb(60, 60, 60);
  color: white;
 }
 body.theme-followsys .win h2.has-close-btn .close:hover {
  background: rgb(80, 80, 80);
 }
 body.theme-followsys .win h2.has-close-btn .close:active {
  background: rgb(30, 30, 30);
 }
 body.theme-followsys .nojs {
  background: rgb(65, 50, 30);
  box-shadow: 0 0 10px black;
 }
 body.theme-followsys #settings .datapack-upload .file-inp::file-selector-button {
  border: 1px solid rgb(100, 100, 100);
  background: rgb(50, 50, 50);
  color: white;
 }
 body.theme-followsys #settings .datapack-upload .file-inp::file-selector-button:hover {
  background: rgb(70, 70, 70);
 }
 body.theme-followsys #settings .datapack-upload .file-inp::file-selector-button:active {
  background: rgb(40, 40, 40);
  border: 1px solid silver;
 }
 body.theme-followsys #settings .datapack-upload .file-inp::file-selector-button:focus {
  outline: 1px dashed deepskyblue;
 }
 body.theme-followsys #settings .datapack-upload .apply-btn {
  background: slateblue;
 }
 body.theme-followsys #settings .datapack-upload .apply-btn:hover {
  background: darkslateblue;
 }
 body.theme-followsys #settings .datapack-upload .apply-btn:active {
  background: rgb(42, 31, 109);
 }
 body.theme-followsys #settings .datapack-upload .apply-btn:focus {
  outline: 2px solid deepskyblue;
 }
 body.theme-followsys #settings .datapack-upload .apply-btn[disabled] {
  background: grey;
 }
 body.theme-followsys #settings .datapack-reset-btn {
  border: 1px solid rgb(100, 100, 100);
  background: rgb(50, 50, 50);
  color: lightskyblue;
 }
 body.theme-followsys #settings .datapack-reset-btn:hover {
  background: rgb(75, 75, 75);
 }
 body.theme-followsys #settings .datapack-reset-btn:active {
  background: rgb(40, 40, 40);
  border: 1px solid silver;
 }
 body.theme-followsys #settings .datapack-reset-btn:focus {
  outline: 2px solid deepskyblue;
 }
 body.theme-followsys #settings .datapack-reset-btn[disabled] {
  background: rgb(75, 75, 75);
  color: grey;
  border: 1px solid rgb(100, 100, 100);
 }
 body.theme-followsys .formula .name {
  background: royalblue;
 }
}

@media (min-width: 400px) {
 .win {
  width: 340px;
  border-radius: 5px;
 }
}
  </style>
 </head>
 <body class="theme-followsys">
  <noscript><div class="nojs"><p>В этом браузере отключена поддержка JavaScript. JS необходим для работы SimpleConverter. Пожалуйста, включите поддержку JavaScript в этом браузере или воспользуйтесь другим браузером/ОС.</p></div></noscript>
  <button class="settings-btn" id="settings-btn" onclick="showSettings()"></button>
  <h1>SimpleConverter</h1>
  <div id="settings" class="win" style="display: none;">
   <h2>Настройки</h2>
   <h3>Загрузка пакета данных</h3>
   <p>Здесь вы можете загрузить JSON-файл с пакетом данных.</p>
   <div class="datapack-upload"><input type="file" id="settings-custom-conv-data-inp" accept="application/json" class="file-inp" /><button onclick="loadCustomConvertData()" id="settings-custom-conv-data-btn" class="apply-btn" disabled>Применить</button></div>
   <button onclick="resetConvertData()" id="settings-reset-conv-data-btn" class="datapack-reset-btn" disabled>Вернуть стандартные данные</button>
   <hr noshade color="silver" />
   <h3>Тема</h3>
   <label><input type="radio" onchange="changeTheme()" name="settings-theme" checked /> Как в системе</label><br />
   <label><input type="radio" onchange="changeTheme()" name="settings-theme" /> Светлая</label><br />
   <label><input type="radio" onchange="changeTheme()" name="settings-theme" /> Тёмная</label>
   <hr noshade color="silver" />
   <h3>О программе</h3>
   <p>SimpleConverter 1.5 <a href="javascript:showVersionChanges()">[список изменений]</a></p>
   <p><i>Дата выпуска версии:</i> 16 фев 2026 (UTC+03:00)</p>
   <p><a href="https://www.github.com/App327/SimpleConverter" target="_blank" class="external">GitHub</a></p>
   <p>© App327, 2025–2026</p>
  </div>
  <div id="changes" class="win" style="display: none;">
   <h2 class="has-close-btn"><span class="text">Список изменений: v1.5</span> <button class="close" onclick="closeVersionChanges()">×</button></h2>
   <p>Что нового в SimpleConverter версии <code>1.5</code> (изменения перечислены в порядке их реализации):</p>
   <ul>
    <li>Улучшена тёмная тема: теперь тёмными становятся кнопки в настройках в разделе «Загрузка пакета данных».</li>
    <li>В нижней части конвертера теперь отображается формула, по которой выполняется конвертация.</li>
    <li>Добавлена новая единица измерения в конвертер «Длина» — <i>миллиметры</i> (<i>мм</i>).</li>
    <li>Незначительные технические изменения.</li>
   </ul>
  </div>
  <select id="conv-type" onchange="changeConverter()"></select>
  <div id="converter">
  </div>

  <script type="application/javascript">
let t = document.getElementById('conv-type');
let c = document.getElementById('converter');

let convJSON = `{ // в процессе разработки
  "format": 1,
  "data": {
    "1": {
      "name": "длина",
      "units": ["мм", "см", "дм", "м", "км"],
      "units_full": ["миллиметры", "сантиметры", "дециметры", "метры", "километры"],
      "formulas": {
        "мм-см": '$ / 10',
        "мм-дм": '$ / 100',
        "мм-м": '$ / 1_000',
        "мм-км": '$ / 1_000_000',
        "см-мм": '$ * 10',
        "см-дм": '$ / 10',
        "см-м": '$ / 100',
        "см-км": '$ / 100_000',
        "дм-мм": '$ * 100',
        "дм-см": '$ * 10',
        "дм-м": '$ / 10',
        "дм-км": '$ / 10_000',
        "м-мм": '$ * 1_000',
        "м-см": '$ * 100',
        "м-дм": '$ * 10',
        "м-км": '$ / 1_000',
        "км-мм": '$ * 1_000_000',
        "км-см": '$ * 100_000',
        "км-дм": '$ * 10_000',
        "км-м": '$ * 1_000',
      }
   },
   2: {
     'name': 'площадь',
     'units': ['см²', 'м²', 'км²'],
     'units_full': ['квадратные сантиметры', 'квадратные метры', 'квадратные километры'],
     'formulas': {
       'см²-м²': '$ / 10_000',
       'м²-см²': '$ * 10_000',
       'см²-км²': '$ / 10_000_000_000',
       'м²-км²': '$ / 1_000_000',
       'км²-м²': '$ * 1_000_000',
       'км²-см²': '$ * 10_000_000_000'
    }
  },
 3: {
  'name': 'масса',
  'units': ['мг', 'г', 'кг'],
  'units_full': ['миллиграммы', 'граммы', 'килограммы'],
  'formulas': {
   'мг-г': '$ / 1_000',
   'мг-кг': '$ / 1_000_000',
   'г-мг': '$ * 1_000',
   'г-кг': '$ / 1_000',
   'кг-мг': '$ * 1_000_000',
   'кг-г': '$ * 1_000'
  }
 }
    }
  }
}`;

let conv = {
 1: {
  'name': 'длина',
  'units': ['мм', 'см', 'дм', 'м', 'км'],
  'units_full': ['миллиметры', 'сантиметры', 'дециметры', 'метры', 'километры'],
  'formulas': {
   'мм-см': '$ / 10',
   'мм-дм': '$ / 100',
   'мм-м': '$ / 1_000',
   'мм-км': '$ / 1_000_000',
   'см-мм': '$ * 10',
   'см-дм': '$ / 10',
   'см-м': '$ / 100',
   'см-км': '$ / 100_000',
   'дм-мм': '$ * 100',
   'дм-см': '$ * 10',
   'дм-м': '$ / 10',
   'дм-км': '$ / 10_000',
   'м-мм': '$ * 1_000',
   'м-см': '$ * 100',
   'м-дм': '$ * 10',
   'м-км': '$ / 1_000',
   'км-мм': '$ * 1_000_000',
   'км-см': '$ * 100_000',
   'км-дм': '$ * 10_000',
   'км-м': '$ * 1_000',
  }
 },
 2: {
  'name': 'площадь',
  'units': ['см²', 'м²', 'км²'],
  'units_full': ['квадратные сантиметры', 'квадратные метры', 'квадратные километры'],
  'formulas': {
   'см²-м²': '$ / 10_000',
   'м²-см²': '$ * 10_000',
   'см²-км²': '$ / 10_000_000_000',
   'м²-км²': '$ / 1_000_000',
   'км²-м²': '$ * 1_000_000',
   'км²-см²': '$ * 10_000_000_000'
  }
 },
 3: {
  'name': 'масса',
  'units': ['мг', 'г', 'кг'],
  'units_full': ['миллиграммы', 'граммы', 'килограммы'],
  'formulas': {
   'мг-г': '$ / 1_000',
   'мг-кг': '$ / 1_000_000',
   'г-мг': '$ * 1_000',
   'г-кг': '$ / 1_000',
   'кг-мг': '$ * 1_000_000',
   'кг-г': '$ * 1_000'
  }
 }
};

let defaultConvData = conv;

let curFrom = 0;
let curTo = 1;

function updateTypes() {
 let opt = '';
 for (let i = 0; i < Object.keys(conv).length; i++) {
  let id = Object.keys(conv)[i];
  let c = conv[id];
  let name = upperCaseFirst(c['name']);
  opt += '<option value="' + id + '">' + name + '</option>';
 }
 t.innerHTML = opt;
}

function changeConverter() {
 curFrom = 0;
 curTo = 1;
 let ct = conv[t.value];
 if (!ct) {
  c.innerHTML = '<p>Конвертер недоступен. Код ошибки: <code>E1</code></p>';
  return false;
 }
 let html = '<h3>Конвертер: ' + ct.name + '</h3>';
 html += '<div class="from-to from"><select id="cc-from-u" onclick="changeFromUnit(true)" class="unit">';
 for (let i = 0; i < ct.units_full.length; i++) {
  let s = '';
  if (i === curFrom) {
   s = ' selected';
  }
  html += '<option value="' + i + '"' + s + '>' + upperCaseFirst(ct.units_full[i]) + ' (' + ct.units[i] + ')</option>';
 }
 html += '</select> <div class="value"><input type="number" id="cc-from-v" oninput="convert()" onchange="convert()" placeholder="123" value="1" /> <p class="u" id="cc-from-ut">' + ct.units[curFrom] + '</p></div></div>';
 html += '<div class="from-to to"><select id="cc-to-u" onclick="changeToUnit(true)" class="unit">';
 for (let i = 0; i < ct.units_full.length; i++) {
  let s = '';
  if (i === curTo) {
   s = ' selected';
  }
  html += '<option value="' + i + '"' + s + '>' + upperCaseFirst(ct.units_full[i]) + ' (' + ct.units[i] + ')</option>';
 }
 html += '</select> <div class="value"><p class="v" id="cc-to-vt">0</p> <p class="u" id="cc-to-ut">' + ct.units[curTo] + '</p></div></div> <div class="formula"><p class="name">Формула</p><p class="text" id="conv-formula-text">???</p></div>';
 c.innerHTML = html;
 convert();
}

function changeFromUnit(fromSwitch = false) {
 let u = document.getElementById('cc-from-u');
 let ut = document.getElementById('cc-from-ut');
 let u0 = document.getElementById('cc-to-u');
 if (u.value === u0.value) {
  u0.value = curFrom;
  changeToUnit();
 }
 ut.innerText = conv[t.value].units[u.value];
 curFrom = Number(u.value);
 if (fromSwitch) {
  convert();
 }
}

function changeToUnit(fromSwitch = false) {
 let u = document.getElementById('cc-to-u');
 let ut = document.getElementById('cc-to-ut');
 let u0 = document.getElementById('cc-from-u');
 if (u.value === u0.value) {
  u0.value = curTo;
  changeFromUnit();
 }
 ut.innerText = conv[t.value].units[u.value];
 curTo = Number(u.value);
 if (fromSwitch) {
  convert();
 }
}

function convert() {
 let from = document.getElementById('cc-from-v');
 let fromu = document.getElementById('cc-from-u');
 let to = document.getElementById('cc-to-vt');
 let tou = document.getElementById('cc-to-u');
 let f = conv[t.value].units[fromu.value];
 let tt = conv[t.value].units[tou.value];
 let frm = document.getElementById('conv-formula-text');
 let v = from.value;
 if (v === '' || isNaN(v)) {
  v = 0;
 }
 let formula = conv[t.value].formulas[f + '-' + tt];
 let frml = formula.replaceAll('*', '×').replaceAll('/', '÷').replaceAll('_', ' ').replaceAll('$', '<i>Исходное значение</i>');
 frm.innerHTML = frml;
 let task = formula.replaceAll('$', v);
 let result = eval(task);
 to.innerText = result;
}

function showSettings() {
 document.getElementById('settings').style.display = 'block';
 let btn = document.getElementById('settings-btn');
 btn.onclick = closeSettings;
 btn.classList.add('opened');
 btn.innerText = '×';
}

function closeSettings() {
 document.getElementById('settings').style.display = 'none';
 let btn = document.getElementById('settings-btn');
 btn.onclick = showSettings;
 btn.classList.remove('opened');
 btn.innerText = '';
}

function showVersionChanges() {
 document.getElementById('changes').style.display = 'block';
}

function closeVersionChanges() {
 document.getElementById('changes').style.display = 'none';
}

document.getElementById('settings-custom-conv-data-inp').onchange = function() {
 let btn = document.getElementById('settings-custom-conv-data-btn');
 if (this.files[0]) {
  btn.disabled = false;
 } else {
  btn.disabled = true;
 }
}

function loadCustomConvertData() {
 let inp = document.getElementById('settings-custom-conv-data-inp');
 let f = inp.files[0];
 if (!f) {
  alert('Загруженный JSON-файл отсутствует!');
  return false;
 }
 let rdr = new FileReader();
 rdr.readAsText(f);
 rdr.onerror = function() {
  alert('Не удалось прочитать JSON-файл.');
  return false;
 }
 rdr.onload = function() {
  let res = rdr.result;
  let j;
  try {
   j = JSON.parse(res);
  } catch (e) {
   alert('Не удалось обработать JSON.\n\n' + e.message);
   return false;
  }
  if (!j['data']) {
   alert('В JSON отсутствует поле «data».');
   return false;
  }
  let d = j.data;
  if (j.format === 1) {
   conv = j.data;
  } else {
   alert('Неподдерживаемый формат JSON-пакета: ' + j.format);
   return false;
  }
  inp.value = null;
  document.getElementById('settings-custom-conv-data-btn').disabled = true;
  document.getElementById('settings-reset-conv-data-btn').disabled = false;
  updateTypes();
  changeConverter();
 }
}

function resetConvertData() {
 conv = defaultConvData;
 updateTypes();
 changeConverter();
 document.getElementById('settings-reset-conv-data-btn').disabled = true;
 document.getElementById('settings-custom-conv-data-inp').value = null;
}

function upperCaseFirst(str) {
 return str[0].toUpperCase() + str.slice(1);
}

function changeTheme() {
 let th = document.getElementsByName('settings-theme');
 let tf = th[0];
 let tl = th[1];
 let td = th[2];
 if (tl.checked) {
  document.body.className = '';
 } else if (td.checked) {
  document.body.className = 'theme-dark';
 } else {
  document.body.className = 'theme-followsys';
 }
}

updateTypes();
changeConverter();
  </script>
 </body>
</html>